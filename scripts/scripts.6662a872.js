"use strict";angular.module("wisableApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainController"}).when("/registration",{templateUrl:"views/registration/registration.html",controller:"RegistrationController"}).when("/subjectpreferences",{templateUrl:"views/registration/subjectpreferences.html",controller:"RegistrationController"}).when("/login",{templateUrl:"views/registration/login.html",controller:"LoginController"}).when("/home",{templateUrl:"views/home.html",controller:"ArticleController"}).when("/article/:articleId",{templateUrl:"views/articles/article.html",controller:"FullArticleController"}).when("/profile",{templateUrl:"views/menuoptions/profile.html",controller:"ProfileController"}).when("/notifications",{templateUrl:"views/menuoptions/notifications.html",controller:"MainController"}).when("/social",{templateUrl:"views/menuoptions/social.html",controller:"MainController"}).when("/interests",{templateUrl:"views/menuoptions/interests.html",controller:"ProfileController"}).when("/likes",{templateUrl:"views/menuoptions/likes.html",controller:"ProfileController"}).when("/configuration",{templateUrl:"views/menuoptions/configuration.html",controller:"MainController"}).otherwise({redirectTo:"/"})}]).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),angular.module("wisableApp").controller("MainController",["$scope","$location","Session",function(a,b,c){a.isCurrentPage=function(a){return a===b.path()},a.currentLocation=b.path(),a.userId=c.userId||localStorage.wisableUserId,a.userId&&b.path("/home")}]),angular.module("wisableApp").config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]).controller("LoginController",["$scope","$http","$location","Session",function(a,b,c,d){var e="http://python-recommender.herokuapp.com/users/";a.invalidCredentials=!1,a.userLogin=function(f,g){console.log("user > "+f+" pass > "+g),b.get(e+"login/"+f+"/"+g+"/").then(function(b){b.data.success===!0?(d.create(f),localStorage.setItem("wisableUserId",f),console.log(localStorage.wisableUserId),c.path("/home")):a.invalidCredentials=!0,console.log("service response > "+JSON.stringify(b.data.success))},function(a){console.error("Error while fetching liked article"+a)})}}]),angular.module("wisableApp").controller("MainNavigationController",["$scope","$location",function(a,b){$(".button-collapse").sideNav({menuWidth:250,activationWidth:70}),a.isCurrentPage=function(a){return a===b.path()},a.currentLocation=b.path(),a.toggleMenu=function(){a.isCollapsed=!a.isCollapsed,$(".overlay").toggleClass("activeOverlay")},a.collapseMenu=function(){a.isCollapsed=!1,$(".overlay").removeClass("activeOverlay"),$(".side-nav.fixed").removeClass("showNav")}}]),angular.module("wisableApp").config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]).controller("RegistrationController",["$scope","$http","$location","Session",function(a,b,c,d){var e="http://python-recommender.herokuapp.com/";a.invalidUser=!1,a.createUser=function(f,g,h){console.log("registering user > "+g+" pass > "+h),b.get(e+"users/register/"+g+"/"+h+"/").then(function(b){b.data.success===!0?(d.create(g),localStorage.setItem("wisableUserId",g),console.log(localStorage.wisableUserId),c.path("/subjectpreferences")):a.invalidUser=!0,console.log("service response > "+JSON.stringify(b.data.success))},function(a){console.error("Error registering user. "+a)}),a.userId=localStorage.wisableUserId},b.get(e+"tags/interests/random/25/").then(function(b){a.interests=b.data},function(a){console.error("Error while fetching tags. "+a)}),a.addPreferences=function(){c.path("/home")},a.selectedInterests=[],a.modifyInterest=function(c){var d=a.selectedInterests.indexOf(c);return d>-1?(a.selectedInterests.splice(d,1),b.get(e+"tags/interests/remove/"+localStorage.wisableUserId+"/"+c+"/").then(function(a){console.log("removed: "+a.data)},function(a){console.error("Error while removing tag. "+a)})):(a.selectedInterests.push(c),b.get(e+"tags/interests/add/"+localStorage.wisableUserId+"/"+c+"/").then(function(a){console.log("added: "+a.data)},function(a){console.error("Error while adding tag. "+a)})),a.selectedInterests}}]),angular.module("wisableApp").config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]).controller("ProfileController",["$scope","$http","$location","Session",function(a,b,c,d){a.userName="Juan Manuel",a.userEmail=d.userId||localStorage.wisableUserId,a.userPassword="";var e="http://python-recommender.herokuapp.com/users/";a.updateUser=function(d,f){console.log("registering user > "+a.userEmail+" pass > "+f),b.get(e+"users/register/"+a.userEmail+"/"+f+"/").then(function(b){b.data.success===!0?c.path("/home"):a.invalidUser=!0,console.log("service response > "+JSON.stringify(b.data.success))},function(a){console.error("Error updating user. "+a)}),a.userId=localStorage.wisableUserId},a.userInterests=[{name:"Arte",id:1,isSelected:!1},{name:"Autos",id:2,isSelected:!1},{name:"Música",id:3,isSelected:!0},{name:"Tecnología",id:4,isSelected:!1},{name:"Cocina",id:5,isSelected:!0},{name:"Películas",id:6,isSelected:!0},{name:"Series de TV",id:7,isSelected:!1},{name:"Famosos",id:8,isSelected:!1}],a.editInterest=function(b){var c=a.selectedInterests.indexOf(b);return c>-1?a.selectedInterests.splice(c,1):a.selectedInterests.push(b),a.selectedInterests},a.userLikes=[{articleId:2,articleTitle:"Awesome title",articleAuthor:"Jack Something",articleCategory:"Cine",articleDate:"21/03/2014"},{articleId:3,articleTitle:"Best title",articleAuthor:"Jane Smith",articleCategory:"Tecnología",articleDate:"05/10/2013"}]}]),angular.module("wisableApp").controller("ArticleController",["$scope","$http","$location","Session",function(a,b,c,d){a.userId=d.userId||localStorage.wisableUserId,a.articles;var e="http://python-recommender.herokuapp.com/articles/";void 0===a.articles&&b.get(e+"home/"+a.userId+"/").then(function(b){a.articles=b.data},function(a){console.error("Error while fetching articles"+a)}),a.likeArticle=function(c){b.get(e+"tastes/like/"+a.userId+"/"+c+"/").then(function(b){a.likeThisArticle=b.data,console.log("service response > "+JSON.stringify(a.likeThisArticle))},function(a){console.error("Error while fetching liked article"+a)})},a.unlikeArticle=function(c){b.get(e+"tastes/dislike/"+a.userId+"/"+c+"/").then(function(b){a.unlikeThisArticle=b.data,console.log("service response > "+JSON.stringify(a.unlikeThisArticle))},function(a){console.error("Error while fetching disliked article"+a)})}}]),angular.module("wisableApp").controller("FullArticleController",["$scope","$http","$location","Session",function(a,b,c,d){var e="http://python-recommender.herokuapp.com/articles/";a.articleId=c.path().slice(9),a.userId=d.userId||"giraldezblack@gmail.com",b.get(e+"details/"+a.userId+"/"+a.articleId+"/").then(function(b){a.fullArticle=b.data},function(a){console.error("Error while fetching article"+a)}),a.likeArticle=function(){b.get("http://python-recommender.herokuapp.com/articles/tastes/like/"+a.userId+"/"+a.articleId+"/").then(function(b){a.likeThisArticle=b.data,console.log("service response > "+JSON.stringify(a.likeThisArticle))},function(a){console.error("Error while fetching liked article"+a)})},a.unlikeArticle=function(){b.get("http://python-recommender.herokuapp.com/articles/tastes/dislike/"+a.userId+"/"+a.articleId+"/").then(function(b){a.unlikeThisArticle=b.data,console.log("service response > "+JSON.stringify(a.unlikeThisArticle))},function(a){console.error("Error while fetching liked article"+a)})},a.showBack=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1}]),angular.module("wisableApp").directive("navbar",function(){return{restrict:"E",templateUrl:"views/mainnav.html",controller:"MainNavigationController",replace:!0}}),angular.module("wisableApp").directive("articleShort",function(){return{restrict:"E",templateUrl:"views/articles/article_short.html",controller:"ArticleController",replace:!0}}),angular.module("wisableApp").directive("toggleClass",function(){return{restrict:"A",link:function(a,b,c){b.bind("click",function(){b.toggleClass(c.toggleClass)})}}}),angular.module("wisableApp").directive("compareValues",function(){return{require:"ngModel",link:function(a,b,c,d){return c.compareValues?(a.$watch(c.compareValues,function(a){void 0!==d.$viewValue&&""!==d.$viewValue&&d.$setValidity("compareValues",a===d.$viewValue)}),void d.$parsers.push(function(b){if(void 0===b||""===b)return d.$setValidity("compareValues",!0),b;var e=b===a.$eval(c.compareValues);return d.$setValidity("compareValues",e),e?b:void 0})):void console.error("compareValues expects a model as an argument!")}}}),angular.module("wisableApp").directive("preloader",function(){return{restrict:"E",templateUrl:"views/preloader.html",controller:"ArticleController",replace:!0}});var wisable=angular.module("wisableApp");wisable.config(["$httpProvider",function(a){a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),wisable.service("Session",function(){return this.create=function(a){this.userId=a},this.destroy=function(){this.userId=null},this});var wisable=angular.module("wisableApp");wisable.filter("decodeURIComponent",function(){return window.decodeURIComponent}),wisable.filter("newlines",function(){return function(a){var b="<p>";return b+=a.replace(/\n/g,"</p><p>"),b+="</p>"}});